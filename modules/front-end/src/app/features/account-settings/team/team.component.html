<div class="table-content-area">
  <div class="table-search-area">
    <nz-input-group [nzPrefix]="prefixIconSearch">
      <input nz-input type="text" placeholder="按邮箱查找" [(ngModel)]="filter.searchText" (ngModelChange)="doSearch(true)">
    </nz-input-group>
    <ng-template #prefixIconSearch>
      <i nz-icon nzType="icons:icon-search"></i>
    </ng-template>
    <button nz-button nzType="primary" (click)="showMemberDrawer()">
      <i nz-icon nzType="icons:icon-add"></i>
      添加成员
    </button>
  </div>

  <div class="table-wrapper">
    <nz-table #table nzSize="small"
              nzShowSizeChanger
              [nzData]="members.items"
              [nzFrontPagination]="false"
              [nzLoading]="isLoading"
              [nzTotal]="members.totalCount"
              [(nzPageSize)]="filter.pageSize"
              (nzPageSizeChange)="doSearch()"
              [nzPageSizeOptions]="[10,20,30]"
              [(nzPageIndex)]="filter.pageIndex"
              (nzPageIndexChange)="doSearch()">
      <thead>
      <tr>
        <th>名称</th>
        <th>电话</th>
        <th>邮箱</th>
        <th>权限</th>
        <th>初始密码</th>
        <th nzAlign="center">操作</th>
      </tr>
      </thead>
      <tbody>
      <tr *ngFor="let member of table.data">
        <td>{{ member.name ?? '--' }}</td>
        <td>{{ member.phoneNumber ?? '未绑定' }}</td>
        <td>{{ member.email ?? '未绑定' }}</td>
        <td>{{ member.role }}</td>
        <td><span *ngIf="member.initialPassword?.length > 0" nz-typography nzCopyable nzCopyText="{{ member.initialPassword }}">{{ member.initialPassword }}</span></td>
        <td style="text-align: center">
          <ng-container *ngIf="canDelete(member)">
            <a style="color: #FF513A"
               nz-popconfirm="确定删除么"
               nzPopconfirmPlacement="bottomRight"
               [nzPopconfirmOverlayStyle]="{minWidth: '240px'}"
               (nzOnConfirm)="deleteMember(member)" [nzIcon]="iconTplMember">
              删除
            </a>
            <ng-template #iconTplMember>
              <i nz-icon nzType="question-circle" nzTheme="fill" style="color: #FAAD14;"></i>
            </ng-template>
          </ng-container>
        </td>
      </tr>
      </tbody>
    </nz-table>
  </div>
</div>

<app-member-drawer [visible]="memberDrawerVisible" (close)="memberDrawerClosed($event)"></app-member-drawer>
